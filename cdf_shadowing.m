% Datos laboratorio 3
datos_lab3 = [
    1       0               -55.5    64.5
    1.1     0.04139268516   -57.4    66.4
    1.2     0.07918124605   -61.8    70.8
    1.3     0.1139433523    -60.3    69.3
    1.4     0.1461280357    -59.9    68.9
    1.5     0.1760912591    -51.3    60.3
    1.6     0.2041199827    -54.7    63.7
    1.7     0.2304489214    -56.5    65.5
    1.8     0.2552725051    -58.4    67.4
    1.9     0.278753601     -57      66
    2       0.3010299957    -60.9    69.9
    2.1     0.3222192947    -58      67
    2.2     0.3424226808    -58.6    67.6
    2.3     0.361727836     -68.9    77.9
    2.4     0.3802112417    -57.8    66.8
    2.5     0.3979400087    -58.1    67.1
    2.6     0.414973348     -61.1    70.1
    2.7     0.4313637642    -64.5    73.5
    2.8     0.4471580313    -56.6    65.6
    2.9     0.4623979979    -57.6    66.6
    3       0.4771212547    -59.5    68.5
    3.1     0.4913616938    -63.9    72.9
    3.2     0.5051499783    -64.6    73.6
    3.3     0.5185139399    -61.9    70.9
    3.4     0.531478917     -60.5    69.5
    3.5     0.5440680444    -64.3    73.3
    3.6     0.5563025008    -61.7    70.7
    3.7     0.5682017241    -63.6    72.6
    3.8     0.5797835966    -63.8    72.8
    3.9     0.591064607     -67.8    76.8
    4       0.6020599913    -61.4    70.4
    5       0.6989700043    -62.1    71.1
    6       0.7781512504    -65.1    74.1
    7       0.84509804      -77.6    86.6
    8       0.903089987     -71.7    80.7
    9       0.9542425094    -76.2    85.2
    10      1               -71.4    80.4
    11      1.041392685     -80.8    89.8
    12      1.079181246     -84.4    93.4
    13      1.113943352     -79      88
    14      1.146128036     -78.2    87.2
    15      1.176091259     -80.7    89.7
    15.5    1.190331698     -79.6    88.6
    16      1.204119983     -80.2    89.2
    16.5    1.217483944     -79.9    88.9
    17      1.230448921     -79.6    88.6
    17.5    1.243038049     -73.4    82.4
    18      1.255272505     -77.9    86.9
    19      1.278753601     -75.8    84.8
    20      1.301029996     -75.4    84.4
];


% Datos laboratorio 4
datos_lab4 = [
    1       0               -47.8    56.8
    1.1     0.04139268516   -49.3    58.3
    1.2     0.07918124605   -49.3    58.3
    1.3     0.1139433523    -46.5    55.5
    1.4     0.1461280357    -49.2    58.2
    1.5     0.1760912591    -51.5    60.5
    1.6     0.2041199827    -49.2    58.2
    1.7     0.2304489214    -56.3    65.3
    1.8     0.2552725051    -53.4    62.4
    1.9     0.278753601     -53.8    62.8
    2       0.3010299957    -61.5    70.5
    2.1     0.3222192947    -57.7    66.7
    2.2     0.3424226808    -58.3    67.3
    2.3     0.361727836     -57.5    66.5
    2.4     0.3802112417    -56.6    65.6
    2.5     0.3979400087    -58.4    67.4
    2.6     0.414973348     -61.2    70.2
    2.7     0.4313637642    -62      71
    2.8     0.4471580313    -55.3    64.3
    2.9     0.4623979979    -58      67
    3       0.4771212547    -60.3    69.3
    3.1     0.4913616938    -56.8    65.8
    3.2     0.5051499783    -59.1    68.1
    3.3     0.5185139399    -62.1    71.1
    3.4     0.531478917     -64.1    73.1
    3.5     0.5440680444    -66.2    75.2
    3.6     0.5563025008    -60.5    69.5
    3.7     0.5682017241    -69.4    78.4
    3.8     0.5797835966    -64.1    73.1
    3.9     0.591064607     -64      73
    4       0.6020599913    -67.2    76.2
    5       0.6989700043    -70      79
    6       0.7781512504    -68.6    77.6
    7       0.84509804      -72.2    81.2
    8       0.903089987     -69.4    78.4
    9       0.9542425094    -71.1    80.1
    10      1               -75.9    84.9
    11      1.041392685     -69.8    78.8
    12      1.079181246     -73.3    82.3
    13      1.113943352     -76.1    85.1
    14      1.146128036     -79.1    88.1
    15      1.176091259     -80.4    89.4
    15.5    1.190331698     -80.3    89.3
    16      1.204119983     -75.3    84.3
    16.5    1.217483944     -78      87
    17      1.230448921     -70.8    79.8
    17.5    1.243038049     -80.4    89.4
    18      1.255272505     -76      85
    19      1.278753601     -75.4    84.4
    20      1.301029996     -79      88
];

%--------------------------------------------------------------------------------
%SHADOWING


modelo1 = fit(datos_lab3(:,2), datos_lab3(:,4), 'poly1'); % Ajuste de un polinomio de primer grado (lineal)
% Calcular la diferencia entre el valor Path Loss y la recta ajustada para Lab 3
SHA_lab3 = datos_lab3(:,4) - feval(modelo1, datos_lab3(:,2));

modelo2 = fit(datos_lab4(:,2), datos_lab4(:,4), 'poly1'); % Ajuste de un polinomio de primer grado (lineal)
% Calcular la diferencia entre el valor Path Loss y la recta ajustada para Lab 4
SHA_lab4 = datos_lab4(:,4) - feval(modelo2, datos_lab4(:,2));

SHA_SUMA = SHA_lab3 + SHA_lab4


% Calcular la función de distribución acumulativa (CDF) para SHA_lab3
[cdf1, x1] = ecdf(SHA_lab3);

% Calcular la CDF para SHA_lab4
[cdf2, x2] = ecdf(SHA_lab4);

% Calcular la CDF para la suma de SHA_lab3 y SHA_lab4
[cdf_suma, x_suma] = ecdf(SHA_SUMA);

% Crear una figura
figure;

% Graficar la CDF para shadowing1
plot(x1, cdf1, 'r', 'LineWidth', 2);
hold on;

% Graficar la CDF para shadowing2
plot(x2, cdf2, 'b', 'LineWidth', 2);

% Graficar la CDF para la suma de shadowing1 y shadowing2
plot(x_suma, cdf_suma, 'g', 'LineWidth', 2);

% Etiquetas y título
xlabel('Shadowing');
ylabel('Probabilidad acumulativa');
title('CDF del Shadowing');

% Leyenda
legend('Lab 3', 'Lab 4', 'Suma de Lab 3 y Lab 4');

% Mostrar la cuadrícula
grid on;

% Mostrar la cuadrícula secundaria
grid minor;

% Mostrar la figura
hold off;
